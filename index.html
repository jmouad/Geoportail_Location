<!DOCTYPE html>
<html>
<head>
	<title>Location immobilière</title>
<link rel="stylesheet" href="leaflet.css">
<script src="leaflet.js"></script>
<script src="rabat.geojson"></script>
<script src="apparts.geojson"></script>
<script src="loca.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<link rel="stylesheet"  href="Leaflet.markercluster-1.4.1\dist\MarkerCluster.css">
<link rel="stylesheet"  href="Leaflet.markercluster-1.4.1\dist\MarkerCluster.Default.css">
<script src="Leaflet.markercluster-1.4.1\dist\leaflet.markercluster-src.js"></script>
<script src="Leaflet.markercluster-1.4.1\src\MarkerCluster.js"></script>

 <!-- Load Esri Leaflet from CDN -->
 <script
 src="https://unpkg.com/esri-leaflet@2.3.3/dist/esri-leaflet.js"
 integrity="sha512-cMQ5e58BDuu1pr9BQ/eGRn6HaR6Olh0ofcHFWe5XesdCITVuSBiBZZbhCijBe5ya238f/zMMRYIMIIg1jxv4sQ=="
 crossorigin=""
></script>

<!-- Load Esri Leaflet Geocoder from CDN -->
<link
 rel="stylesheet"
 href="https://unpkg.com/esri-leaflet-geocoder@2.3.2/dist/esri-leaflet-geocoder.css"
 integrity="sha512-IM3Hs+feyi40yZhDH6kV8vQMg4Fh20s9OzInIIAc4nx7aMYMfo+IenRUekoYsHZqGkREUgx0VvlEsgm7nCDW9g=="
 crossorigin=""
/>
<script
 src="https://unpkg.com/esri-leaflet-geocoder@2.3.2/dist/esri-leaflet-geocoder.js"
 integrity="sha512-8twnXcrOGP3WfMvjB0jS5pNigFuIWj4ALwWEgxhZ+mxvjF5/FBPVd5uAxqT8dd2kUmTVK9+yQJ4CmTmSg/sXAQ=="
 crossorigin=""
></script>

<style>
 body {
   margin: 0;
   padding: 0;
 }
 #map {
   position: absolute;
   top: 0;
   bottom: 0;
   right: 0;
   left: 0;
 } 
</style>

</head>

<body>
  
    <nav class="rounded mx-auto d-block" style="background-color: #c4c6c7;">
      <div class="container">
        <a class="navbar-brand" href="index.html">
          <img src="location1.png" class="rounded mx-auto d-block" alt="location" width="120" height="30">
        </a>
      </div>
    </nav>
  
<div id='map' style="width: 1365px; height: 632px;float:right;padding: 15px;margin-bottom: 15px; margin-top: 31px;">  
</div>

  <script type="text/javascript">
var map = L.map('map', {
    center: [33.9800, -6.8483],
    zoom:12,
});

var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
}).addTo(map);



var OpenStreetMap_Mapnik = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
	maxZoom: 19,
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
});
var Stadia_AlidadeSmooth = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png', {
	maxZoom: 20,
	attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
});


var house = L.icon({
    iconUrl: 'house_icon_.svg',
    iconSize:[5, 5], // size of the icon
});
L.marker([33.99623844855088,-6.858864310995273 ],{icon: house}).addTo(map)
      .bindPopup("Prix= 4500 MAD <br> superficie= 80 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage  <center> <img src='appartements\appart1.jfif'" + "' style='width:200px;height:300x;'></center>")
    L.marker([34.009146920932842,-6.859421477095726],{icon: house}).addTo(map)
      .bindPopup("Prix= 6300 MAD <br> superficie= 61 m²<br> Nombre de piéces=4 piéces<br> Deuxiéme étage  <center> <img src='appartements/appart17.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.995980110058284, -6.857598443080974],{icon: house}).addTo(map)
      .bindPopup("Prix= 3520 MAD <br> superficie= 48 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage  <center> <img src='appartements/appart18.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.99659366269593,-6.85518355659957],{icon: house}).addTo(map)
      .bindPopup("Prix= 4200 MAD <br> superficie= 59 m²<br> Nombre de piéces=4 piéces<br> troisième  étage  <center> <img src='appartements/appart19.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.99616579092921,-6.855193294044824],{icon: house}).addTo(map)
      .bindPopup("Prix= 5300 MAD <br> superficie= 62 m²<br> Nombre de piéces=3 piéces<br> quatrième  étage  <center> <img src='appartements/appart20.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.995126850687555 ,-6.857756268536889],{icon: house}).addTo(map)
      .bindPopup("Prix= 5200 MAD <br> superficie= 73 m²<br> Nombre de piéces=4 piéces<br> Deuxiéme étage  <center> <img src='appartements/appart21.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.994917875935954 ,-6.855209469599629],{icon: house}).addTo(map)
      .bindPopup("Prix= 4300 MAD <br> superficie= 76 m²<br> Nombre de piéces=3 piéces<br> troisième  étage  <center> <img src='appartements/appart22.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.995052838855415,-6.855645313542226],{icon: house}).addTo(map)
      .bindPopup("Prix= 5100 MAD <br> superficie= 58 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage <center> <img src='appartements/appart23.JFIF'" + "' style='width:200px;'></center>")
      
	  L.marker([34.00004742808903,-6.852286327783442],{icon: house}).addTo(map)
      .bindPopup("Prix= 4500 MAD <br> superficie= 56 m²<br> Nombre de piéces=3 piéces<br> troisième  étage  <center> <img src='appartements/appart24.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([34.00243203489633,-6.847149746458172],{icon: house}).addTo(map)
      .bindPopup("Prix= 4600 MAD <br> superficie= 49 m²<br> Nombre de piéces=2 piéces<br> quatrième  étage  <center> <img src='appartements/appart25.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.99856414606488 ,-6.84595239438363],{icon: house}).addTo(map)
      .bindPopup("Prix= 3800 MAD <br> superficie= 42 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage  <center> <img src='appartements/appart26.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([34.00104577584494,-6.847927336165242],{icon: house}).addTo(map)
      .bindPopup("Prix= 3900 MAD <br> superficie= 48 m²<br> Nombre de piéces=3 piéces<br> troisième  étage <center> <img src='appartements/appart27.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([34.00159914100077,-6.849565093600489],{icon: house}).addTo(map)
      .bindPopup("Prix= 4900 MAD <br> superficie= 46 m²<br> Nombre de piéces=4 piéces<br> Deuxiéme étage <center> <img src='appartements/appart28.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.99739434849218,-6.849480814549793],{icon: house}).addTo(map)
      .bindPopup("Prix= 6100M AD <br> superficie= 73 m²<br> Nombre de piéces=3 piéces<br> quatrième  étage  <center> <img src='appartements/appart29.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.99823233566211,-6.850322181045925],{icon: house}).addTo(map)
      .bindPopup("Prix= 5800 MAD <br> superficie= 91 m²<br> Nombre de piéces=4 piéces<br> Deuxiéme étage  <center> <img src='appartements/appart30.JFIF'" + "' style='width:200px;'></center>")
      
	  L.marker([33.99814338769568 ,-6.847126117711014],{icon: house}).addTo(map)
      .bindPopup("Prix= 4700 MAD <br> superficie= 85 m²<br> Nombre de piéces=3 piéces<br> troisième  étage  <center> <img src='appartements/appart31.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.99593740412101,-6.847559018523867],{icon: house}).addTo(map)
      .bindPopup("Prix= 3700 MAD <br> superficie= 68 m²<br> Nombre de piéces=4 piéces<br> Deuxiéme étage  <center> <img src='appartements/appart32.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.995686450846975,-6.849007011788302],{icon: house}).addTo(map)
      .bindPopup(" Prix= 5200 MAD <br> superficie= 75 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage <center> <img src='appartements/appart33.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.99507261436986,-6.847134403214284],{icon: house}).addTo(map)
      .bindPopup("Prix= 7000 MAD <br> superficie= 84 m²<br> Nombre de piéces=2 piéces<br> troisième  étage  <center> <img src='appartements/appart34.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([33.99433505125678,-6.848614119233673],{icon: house}).addTo(map)
      .bindPopup("Prix= 3900 MAD <br> superficie= 86 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage  <center> <img src='appartements/appart35.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([34.003301755627675,-6.847907194325785],{icon: house}).addTo(map)
      .bindPopup("Prix= 4500 MAD <br> superficie= 82 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage<center> <img src='appartements/appart36.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([34.00200864403644 ,-6.8483901289017695],{icon: house}).addTo(map)
      .bindPopup("Prix= 5300 MAD <br> superficie= 42 m²<br> Nombre de piéces=4 piéces<br> troisième  étage<center> <img src='appartements/appart37.JFIF'" + "' style='width:200px;'></center>")
      
    L.marker([34.0020868755463,-6.846314065323725],{icon: house}).addTo(map)
      .bindPopup("Prix= 4100 MAD <br> superficie= 65 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")

    L.marker([34.001484003662284,-6.8527661731254454],{icon: house}).addTo(map)
      .bindPopup("Prix= 6200 MAD <br> superficie= 76 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")

    L.marker([34.0020009252039,-6.853331020514702],{icon: house}).addTo(map)
      .bindPopup("Prix= 3600 MAD <br> superficie= 86 m²<br> Nombre de piéces=3 piéces<br> troisième  étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")  
      
    L.marker([33.99697859764672,-6.84496896416303],{icon: house}).addTo(map)
      .bindPopup("Prix= 4000 MAD <br> superficie= 95 m²<br> Nombre de piéces=4 piéces<br> Deuxiéme étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")

    L.marker([33.99655688569223,-6.846355724250827],{icon: house}).addTo(map)
      .bindPopup("Prix= 6500 MAD <br> superficie= 62 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")

    L.marker([33.99975735455246,-6.848726425984552],{icon: house}).addTo(map)
      .bindPopup("Prix= 3500 MAD <br> superficie= 43 m²<br> Nombre de piéces=3 piéces<br> troisième  étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")

    L.marker([33.99917273832247,-6.848783005804961],{icon: house}).addTo(map)
      .bindPopup("Prix= 5800 MAD <br> superficie= 56 m²<br> Nombre de piéces=2 piéces<br> quatrième  étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")

    L.marker([34.00100236809337,-6.845776461239723],{icon: house}).addTo(map)
      .bindPopup("Prix= 3000 MAD <br> superficie= 65 m²<br> Nombre de piéces=3 piéces<br> Deuxiéme étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")

    L.marker([33.998660278044156,-6.8447294187277805],{icon: house}).addTo(map)
      .bindPopup("Prix= 5600 MAD <br> superficie= 78 m²<br> Nombre de piéces=3 piéces<br> troisième  étage <center> <img src='appartements/appart38.JFIF'" + "' style='width:200px;'></center>")
      
      
      
      
      
      const searchControl = L.esri.Geocoding.geosearch().addTo(map);

      const results = L.layerGroup().addTo(map);

let markers = [];

searchControl.on("results", function (data) {
  markers = [];
  console.log("data", data);
  results.clearLayers();

  // several results as several towns with same name (like)
  for (var i = data.results.length - 1; i >= 0; i--) {
    const result = data.results[i];
    const marker = L.marker(result.latlng);
    markers = [...markers, L.marker(marker)];
    results.addLayer(marker);
    marker.on("click", addRadius);
    console.log("markers", markers);
  }
});

function addRadius(marker, radius = 500) {
  console.log("marker clicked", marker);
  const circle = L.circle([marker.latlng.lat, marker.latlng.lng], {
    radius,
  });
  console.log("circle", circle);
  circle.addTo(map);
  setTimeout(() => {
    map.setZoom(15);
  }, 500);
}

	// get color of features
	function getColor(color) {
		return color == "apparts.geojson" 
		  	       '#0000FF';
  }

	function styleFeature(feature) {
		return {
			weight: 3,
			opacity: 1,
			color: 'red',
			dashArray: '3',
			fillOpacity: 0.6,
			fillColor: getColor(feature.properties.name)
		};
	}

var geoJson = L.geoJson(apparts, {
		style: styleFeature,
	}, {icon: house}).addTo(map);

var geoJsn = L.geoJson(rabat).addTo(map);

//geojson marker data 
var marker = L.markerClusterGroup();
var markr = L.geoJson(loca);

// laeflet marker cluster
marker.addLayer(markr);
map.addLayer(marker);





// leaflet layer controller
var basemaps = {
    "Esri_WorldImagery":Esri_WorldImagery,
    "OpenStreetMap":OpenStreetMap_Mapnik,
    "Stadia_AlidadeSmooth":Stadia_AlidadeSmooth,
}

var overlaymaps = {
    'Rabat':geoJsn,
    'Appartements':geoJson,
    'Localisation':markr,
}

L.control.layers(basemaps,overlaymaps).addTo(map);


L.Control.Watermark=L.Control.extend({
            onAdd:function(map){
                var img = L.DomUtil.create('img');
                img.src = 'mison.svg';
                img.style.width = '80px';
                return img;
                },
                onRemove:function(map){},
                });
                L.control.watermark = function(opts){
                    return new L.Control.Watermark(opts);
                    }
                L.control.watermark({position:'bottomleft'}).addTo(map);









</script>	
</body>
</html>
